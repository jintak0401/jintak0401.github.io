---
title: "[ë°±ì¤€ 17435] í•©ì„±í•¨ìˆ˜ì™€ ì¿¼ë¦¬ (íŒŒì´ì¬ / Python)"
author: HashTable
categories: [ì•Œê³ ë¦¬ì¦˜, ë°±ì¤€]
tags: [ì•Œê³ ë¦¬ì¦˜, ë°±ì¤€, í¬ì†Œ ë°°ì—´]
date: 2022-04-16 15:30:00 +0900
math: true
---

---
## ğŸ“‘ ë¬¸ì œ

ë¬¸ì œë§í¬ : [í•©ì„±í•¨ìˆ˜ì™€ ì¿¼ë¦¬](https://www.acmicpc.net/problem/17435){:target="_blank"}

---
## ğŸ¤” ìƒê°ì˜ íë¦„

ì–¼ë§ˆ ì „ì— ì•Œê²Œëœ í¬ì†Œ ë°°ì—´ ì•Œê³ ë¦¬ì¦˜ì„ ì¨ì•¼ê² ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.
'í¬ì†Œ ë°°ì—´ì´ ë­ì§€?' í•˜ì‹œëŠ” ë¶„ë“¤ì€ [ì´ ê¸€](https://jintak0401.github.io/posts/theory-sparse-array/){:target="_blank"}ì„ ë³´ê³  ì™€ì£¼ì„¸ìš”.

---

## ğŸ¯ í’€ì´ë°©ë²•

**í¬ì†Œ ë°°ì—´** ë¬¸ì œì´ë©°, ì‹œê°„ë³µì¡ë„ëŠ” $O((m + Q) \log N)$ ì…ë‹ˆë‹¤.

> **move[i][j]** : j ë²ˆ ë…¸ë“œê°€ $2^i$ ë²ˆ ì´ë™í–ˆì„ ë•Œì˜ ìœ„ì¹˜
{:.prompt-info}

1. í¬ì†Œ ë°°ì—´ ì•Œê³ ë¦¬ì¦˜ì„ ìœ„í•œ ì „ì²˜ë¦¬ë¥¼ í•´ì¤ë‹ˆë‹¤.

2. ì…ë ¥ë°›ì€ ì¿¼ë¦¬ë¥¼ ì „ì²˜ë¦¬í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì´ìš©í•˜ì—¬ êµ¬í•©ë‹ˆë‹¤.

---
## ğŸ” ìœ ì˜í•  ì 

* í¬ì†Œ ë°°ì—´ ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•˜ê³  í‘¼ë‹¤ë©´ í¬ê²Œ ìœ ì˜í•  ì ì€ ì—†ìŠµë‹ˆë‹¤.

---

## ğŸ’» ì½”ë“œ

```python
from sys import stdin

input = stdin.readline


def solve():
    m = int(input())

    # log2(500_000) + 1 = 19
    length = 19

    # move[i][j]: f_2^i(j)
    move = [[0] * (m + 1) for _ in range(length)]
    move[0][1:m+1] = [*map(int, input().split())]

    for i in range(1, length):
        for j in range(1, m + 1):
            move[i][j] = move[i-1][move[i-1][j]]

    Q = int(input())
    for _ in range(Q):
        n, x = map(int, input().split())
        idx = 0
        while (1 << idx) <= n:
            if n & (1 << idx):
                x = move[idx][x]
            idx += 1
        print(x)


if __name__ == '__main__':
    solve()
```
