---
title: "[ë°±ì¤€ 4195] ì¹œêµ¬ ë„¤íŠ¸ì›Œí¬ (íŒŒì´ì¬ / Python)"
author: HashTable
categories: [ì•Œê³ ë¦¬ì¦˜, ë°±ì¤€]
tags: [ì•Œê³ ë¦¬ì¦˜, ë°±ì¤€, Disjoint Set]
date: 2022-04-18 16:26:00 +0900
img_path: /blog-assets/boj/4195
math: true
---

---
## ðŸ“‘ ë¬¸ì œ

ë¬¸ì œë§í¬ : [ì¹œêµ¬ ë„¤íŠ¸ì›Œí¬](https://www.acmicpc.net/problem/4195){:target="_blank"}

---
## ðŸ¤” ìƒê°ì˜ íë¦„

Disjoint Set ìžë£Œêµ¬ì¡°ê°€ í•„ìš”í•œ ë¬¸ì œìž…ë‹ˆë‹¤. ê·€ì°®ì€ ë¶€ë¶„ì€ ì´ë¦„ì´ ìˆ«ìžë¡œ ì£¼ì–´ì§„ ê²ƒì´ ì•„ë‹ˆë¼ ë¬¸ìžì—´ë¡œ ì´ë£¨ì–´ì§„ ì ê³¼ ì‚¬ëžŒì´
ì´ ëª‡ ëª…ì¸ì§€ ëª¨ë¥´ëŠ” ì ìž…ë‹ˆë‹¤.

![ê·¸ë¦¼1](figure1.svg)

ë¬¸ìžì—´ ì´ë¦„ì€ ë”•ì…”ë„ˆë¦¬ë¥¼ ì´ìš©í•´ì„œ ì²˜ë¦¬í•´ì£¼ë©´ ë  ê²ƒ ê°™ë„¤ìš”. ì²˜ë¦¬í•´ì£¼ëŠ” ë°©ë²•ì€ ë””í…Œì¼í•˜ê²Œ 2ê°€ì§€ê°€ ìžˆìŠµë‹ˆë‹¤.

1. ë”•ì…”ë„ˆë¦¬ key ê°’ì— ì‚¬ëžŒ ì´ë¦„ì„ ë‹´ê³ , value ê°’ìœ¼ë¡œ ë£¨íŠ¸ë…¸ë“œê°€ ì•„ë‹ˆë¼ë©´ ë¶€ëª¨ì˜ ì´ë¦„ì„, ë£¨íŠ¸ ë…¸ë“œë¼ë©´ í•´ë‹¹ tree ì˜ ë…¸ë“œ
ê°¯ìˆ˜ë¥¼ ì €ìž¥í•˜ëŠ” ë°©ë²•

2. ë”•ì…”ë„ˆë¦¬ key ê°’ì— ì‚¬ëžŒ ì´ë¦„ì„ ë‹´ê³  value ê°’ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ì˜ ì¸ë±ìŠ¤ ë²ˆí˜¸ë¥¼ ì €ìž¥í•˜ì—¬, ë¦¬ìŠ¤íŠ¸ë¥¼ ì´ìš©í•´ disjoint set ì„
êµ¬í˜„í•˜ëŠ” ë°©ë²•

ì„¤ëª…ì€ 1ë²ˆ ë°©ë²•ìœ¼ë¡œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤ë§Œ ì½”ë“œëŠ” 1ë²ˆ í’€ì´ì™€ 2ë²ˆ í’€ì´ ë‘˜ ë‹¤ ìž‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

---

## ðŸŽ¯ í’€ì´ë°©ë²•

**Disjoint Set** ë¬¸ì œìž…ë‹ˆë‹¤.

> **disjoint_set** : ë”•ì…”ë„ˆë¦¬ë¡œ ì´ë£¨ì–´ì§„ Disjoint Set ìžë£Œêµ¬ì¡°. key ì—ëŠ” ì‚¬ëžŒì˜ ì´ë¦„ì´, value ì—ëŠ” ìžì‹ë…¸ë“œë¼ë©´
> ë¶€ëª¨ ì´ë¦„, ë¶€ëª¨ë…¸ë“œë¼ë©´ í•´ë‹¹ íŠ¸ë¦¬ì˜ ì›ì†Œ ê°¯ìˆ˜ê°€ ë‹´ê¹ë‹ˆë‹¤.
>
> **union(a, b)** : disjoint_set ì—ì„œ a ë¥¼ b ì˜ ìžì‹ìœ¼ë¡œ í•©ì¹˜ëŠ” í•¨ìˆ˜ìž…ë‹ˆë‹¤. b ëŠ” ë…¸ë“œ ê°¯ìˆ˜ê°€ ì¦ê°€í•˜ë©° a ëŠ” value ê°’ì´
> bë¡œ ë°”ë€ë‹ˆë‹¤.
>
> **find(a)** : disjoint_set ì—ì„œ a ì˜ ë£¨íŠ¸ë…¸ë“œë¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜ìž…ë‹ˆë‹¤.
{:.prompt-info}

1. disjoint set ì„ ìœ„í•œ ë”•ì…”ë„ˆë¦¬ë¥¼ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

2. 2ëª…ì”© ì‚¬ëžŒ ì´ë¦„ì„ ìž…ë ¥ë°›ìŠµë‹ˆë‹¤. ë§Œì•½ ì²˜ìŒ ìž…ë ¥ë°›ëŠ” ì´ë¦„ì´ë¼ë©´ disjoint set ë”•ì…”ë„ˆë¦¬ì— 1 ê°’ì„ value ë¡œ ê°–ë„ë¡
ë„£ì–´ì£¼ì–´ ë£¨íŠ¸ë…¸ë“œë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

3. ë‘ ì‚¬ëžŒì˜ ë£¨íŠ¸ë…¸ë“œë¥¼ find í•¨ìˆ˜ë¥¼ ì´ìš©í•´ êµ¬í•´ì¤ë‹ˆë‹¤.
   1. ë™ì¼í•œ ë£¨íŠ¸ ë…¸ë“œë¥¼ ê°€ì§€ëŠ” ê²½ìš°, ì•„ë¬´ê²ƒë„ í•´ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.
   2. ë‹¤ë¥¸ ë£¨íŠ¸ë…¸ë“œë¥¼ ê°€ì§„ ê²½ìš°, ë…¸ë“œì˜ ê°¯ìˆ˜ê°€ ì ì€ íŠ¸ë¦¬ë¥¼ ë” ë§Žì€ íŠ¸ë¦¬ë¡œ í•©ì³ì¤ë‹ˆë‹¤.

4. 3ë²ˆì„ ìˆ˜í–‰í•œ í›„ ë£¨íŠ¸ë…¸ë“œì˜ value ê°’ì„ ì¶œë ¥í•´ì¤ë‹ˆë‹¤.

---
## ðŸ”Ž ìœ ì˜í•  ì 

* ë™ì¼í•œ ë£¨íŠ¸ë¥¼ ê°–ëŠ” ì‚¬ëžŒë“¤ì„ ìž…ë ¥ë°›ì€ ê²½ìš° union ì„ í•´ì£¼ë©´ ì•ˆë©ë‹ˆë‹¤. (í•´ì¤¬ì„ ë•Œ ë©”ëª¨ë¦¬ì´ˆê³¼ê°€ ë‚˜ì˜¤ë”ë¼êµ¬ìš”.)

* union ì´ë‚˜ find í•¨ìˆ˜ë¥¼ ìž¬ê·€í•¨ìˆ˜ë¡œ êµ¬í˜„í•˜ëŠ” ê²½ìš°, ìž¬ê·€í•¨ìˆ˜ì˜ ê¹Šì´ê°€ 1000ì´ ë„˜ì–´ê°ˆ ìˆ˜ ìžˆìœ¼ë‹ˆ
setrecursionlimit ìœ¼ë¡œ ìž¬ê·€í•¨ìˆ˜ ê¹Šì´ë¥¼ ë†’ì—¬ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

---

## ðŸ’» ì½”ë“œ

### ë”•ì…”ë„ˆë¦¬ë§Œ ì´ìš©
```python
from sys import stdin

input = stdin.readline


def solve():
    TC = int(input())

    # aë¥¼ bì˜ ìžì‹ìœ¼ë¡œ ì—°ê²°
    def union(a, b):
        disjoint_set[b] += disjoint_set[a]
        disjoint_set[a] = b
        return disjoint_set[b]

    def find(a):
        while isinstance(disjoint_set[a], str):
            a = disjoint_set[a]
        return a

    for _ in range(TC):
        F = int(input())
        # ìžì‹ì´ë¦„: ë¶€ëª¨ì´ë¦„ or ì§‘í•© ê°¯ìˆ˜
        disjoint_set = {}
        for _ in range(F):
            a, b = input().split()
            if a not in disjoint_set:
                disjoint_set[a] = 1
            if b not in disjoint_set:
                disjoint_set[b] = 1

            a, b = find(a), find(b)
            if a == b:
                print(disjoint_set[a])
            else:
                a_val, b_val = disjoint_set[a], disjoint_set[b]
                if a_val > b_val:
                    print(union(b, a))
                else:
                    print(union(a, b))


if __name__ == '__main__':
    solve()
```

### ë¦¬ìŠ¤íŠ¸ë„ ì´ìš©
```python
from sys import stdin

input = stdin.readline


def solve():
    TC = int(input())

    # aë¥¼ bì˜ ìžì‹ìœ¼ë¡œ ì—°ê²°
    def union(a, b):
        disjoint_set[b] += disjoint_set[a]
        disjoint_set[a] = b
        return -disjoint_set[b]

    def find(a):
        while disjoint_set[a] >= 0:
            a = disjoint_set[a]
        return a

    for _ in range(TC):
        F = int(input())
        disjoint_set = []
        name = {}
        for _ in range(F):
            a, b = input().split()
            if a not in name:
                name[a] = len(name.keys())
                disjoint_set.append(-1)
            if b not in name:
                name[b] = len(name.keys())
                disjoint_set.append(-1)

            a, b = find(name[a]), find(name[b])
            if a == b:
                print(-disjoint_set[a])
            elif a < b:
                print(union(b, a))
            else:
                print(union(a, b))


if __name__ == '__main__':
    solve()
```
